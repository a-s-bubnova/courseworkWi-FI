<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wi-Fi –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –ú–æ—Å–∫–≤–∞</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            height: 100vh;
            display: flex;
            overflow: hidden;
        }

        /* –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è */
        .sidebar {
            width: 400px;
            background: #f8f9fa;
            border-right: 1px solid #dee2e6;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
        }

        .sidebar-header {
            background: #282c34;
            color: white;
            padding: 20px;
            text-align: center;
        }

        .sidebar-header h1 {
            font-size: 20px;
            margin-bottom: 5px;
        }

        .sidebar-header p {
            font-size: 12px;
            opacity: 0.9;
        }

        .sidebar-content {
            flex: 1;
            padding: 20px;
        }


        /* –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è */
        .controls-section {
            margin-bottom: 20px;
        }

        .btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            width: 100%;
            margin-bottom: 10px;
        }

        .btn:hover {
            background: #0056b3;
        }

        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .btn-secondary {
            background: #6c757d;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        /* –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ—á–∫–∞—Ö */
        .points-info {
            margin-bottom: 20px;
            padding: 15px;
            background: white;
            border-radius: 4px;
            border: 1px solid #dee2e6;
        }

        .points-info h3 {
            font-size: 16px;
            margin-bottom: 10px;
            color: #333;
        }

        .point-item {
            margin-bottom: 10px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 4px;
            font-size: 12px;
        }

        .point-item strong {
            display: block;
            margin-bottom: 5px;
            color: #333;
        }

        .point-item span {
            color: #666;
            word-break: break-all;
        }

        /* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ */
        .statistics {
            padding: 15px;
            background: #e7f3ff;
            border-radius: 4px;
            border: 1px solid #b3d9ff;
        }

        .statistics h3 {
            font-size: 16px;
            margin-bottom: 10px;
            color: #333;
        }

        .stat-item {
            margin-bottom: 8px;
            font-size: 13px;
        }

        .stat-item strong {
            color: #333;
        }

        .wifi-points-list {
            margin-top: 10px;
            max-height: 200px;
            overflow-y: auto;
        }

        .wifi-point-item {
            padding: 8px;
            margin-bottom: 5px;
            background: white;
            border-radius: 4px;
            font-size: 12px;
            border-left: 3px solid #007bff;
        }

        .wifi-point-item strong {
            display: block;
            color: #333;
            margin-bottom: 3px;
        }

        .wifi-point-item .address {
            color: #666;
            font-size: 11px;
        }

        /* –ö–∞—Ä—Ç–∞ */
        .map-container {
            flex: 1;
            position: relative;
        }

        #map {
            width: 100%;
            height: 100%;
        }

        /* –°–æ–æ–±—â–µ–Ω–∏—è */
        .error {
            color: #dc3545;
            margin: 10px 0;
            padding: 10px;
            background: #f8d7da;
            border-radius: 4px;
            font-size: 12px;
        }

        .loading {
            color: #007bff;
            margin: 10px 0;
            padding: 10px;
            background: #d1ecf1;
            border-radius: 4px;
            font-size: 12px;
        }

        .hidden {
            display: none;
        }

        /* –†–∞–¥–∏–æ–∫–Ω–æ–ø–∫–∏ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ç–∏–ø–∞ –º–∞—Ä—à—Ä—É—Ç–∞ */
        input[type="radio"] {
            cursor: pointer;
        }

        label[for], label > input[type="radio"] {
            cursor: pointer;
        }

        /* –§–∏–ª—å—Ç—Ä—ã */
        .filter-group {
            font-size: 13px;
        }

        /* –õ–µ–≥–µ–Ω–¥–∞ */
        .legend {
            font-size: 12px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 6px;
        }

        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            margin-right: 8px;
            border: 1px solid #ddd;
        }

        /* –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è */
        .auth-section {
            padding: 25px;
            background: white;
            border-bottom: 1px solid #dee2e6;
        }
        
        .auth-form {
            width: 100%;
        }
        
        .auth-form h3 {
            font-size: 20px;
            margin-bottom: 20px;
            color: #333;
            text-align: center;
        }
        
        .auth-input-group {
            margin-bottom: 16px;
        }
        
        .auth-input-group label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 8px;
            color: #555;
        }
        
        .auth-input {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 15px;
            box-sizing: border-box;
        }
        
        .auth-input:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 2px rgba(0,123,255,0.25);
        }
        
        .user-info {
            padding: 20px;
            background: #f8f9fa;
            border-radius: 4px;
        }
        
        .user-info p {
            margin-bottom: 12px;
            font-size: 15px;
        }

    </style>
</head>
<body>
    <!-- –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
    <div class="sidebar">
        <div class="sidebar-header">
            <h1>Wi-Fi –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è</h1>
            <p>–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–æ–≤ —á–µ—Ä–µ–∑ —Ç–æ—á–∫–∏ Wi-Fi –≤ –ú–æ—Å–∫–≤–µ</p>
        </div>
        
        <!-- –§–æ—Ä–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
        <div id="auth-section" class="auth-section">
            <div id="login-form" class="auth-form">
                <h3>–í—Ö–æ–¥</h3>
                <div class="auth-input-group">
                    <label>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label>
                    <input type="text" id="login-username" class="auth-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
                </div>
                <div class="auth-input-group">
                    <label>–ü–∞—Ä–æ–ª—å:</label>
                    <input type="password" id="login-password" class="auth-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å">
                </div>
                <button class="btn" onclick="login()">–í–æ–π—Ç–∏</button>
                <p style="text-align: center; margin-top: 10px; font-size: 12px;">
                    –ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? <a href="#" onclick="showRegisterForm(); return false;" style="color: #007bff;">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</a>
                </p>
            </div>
            
            <div id="register-form" class="auth-form" style="display: none;">
                <h3>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h3>
                <div class="auth-input-group">
                    <label>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label>
                    <input type="text" id="register-username" class="auth-input" placeholder="–ú–∏–Ω–∏–º—É–º 3 —Å–∏–º–≤–æ–ª–∞">
                </div>
                <div class="auth-input-group">
                    <label>Email:</label>
                    <input type="email" id="register-email" class="auth-input" placeholder="example@mail.com">
                </div>
                <div class="auth-input-group">
                    <label>–ü–∞—Ä–æ–ª—å:</label>
                    <input type="password" id="register-password" class="auth-input" placeholder="–ú–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤">
                </div>
                <button class="btn" onclick="register()">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
                <p style="text-align: center; margin-top: 10px; font-size: 12px;">
                    –£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? <a href="#" onclick="showLoginForm(); return false;" style="color: #007bff;">–í–æ–π—Ç–∏</a>
                </p>
            </div>
            
            <div id="user-info" class="user-info" style="display: none;">
                <p><strong>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:</strong> <span id="current-username"></span></p>
                <button class="btn btn-secondary" onclick="logout()">–í—ã–π—Ç–∏</button>
            </div>
        </div>
        
        <div class="sidebar-content" id="main-content" style="display: none;">
            <!-- –í—ã–±–æ—Ä —Ç–æ—á–µ–∫ –Ω–∞ –∫–∞—Ä—Ç–µ -->
            <div class="controls-section">
                <h3>–í—ã–±–æ—Ä —Ç–æ—á–µ–∫ –º–∞—Ä—à—Ä—É—Ç–∞</h3>
                <p style="font-size: 12px; color: #666; margin-bottom: 15px;">
                    –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –∫–∞—Ä—Ç–µ, —á—Ç–æ–±—ã –≤—ã–±—Ä–∞—Ç—å —Ç–æ—á–∫–∏ A –∏ B –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –º–∞—Ä—à—Ä—É—Ç–∞
                </p>
                
                <!-- –í—ã–±–æ—Ä —Ç–∏–ø–∞ –º–∞—Ä—à—Ä—É—Ç–∞ -->
                <div style="margin-top: 15px; margin-bottom: 10px;">
                    <label style="display: block; font-size: 12px; font-weight: 600; margin-bottom: 8px; color: #555;">
                        –¢–∏–ø –º–∞—Ä—à—Ä—É—Ç–∞:
                    </label>
                    <div style="display: flex; flex-direction: column; gap: 8px;">
                        <label style="display: flex; align-items: center; font-size: 13px; cursor: pointer;">
                            <input type="radio" name="route-type" value="shortest" checked style="margin-right: 8px;">
                            <span>–ö—Ä–∞—Ç—á–∞–π—à–∏–π –ø—É—Ç—å</span>
                        </label>
                        <label style="display: flex; align-items: center; font-size: 13px; cursor: pointer;">
                            <input type="radio" name="route-type" value="max_coverage" style="margin-right: 8px;">
                            <span>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ Wi-Fi</span>
                        </label>
                    </div>
                </div>
                
                <button class="btn" onclick="buildRoute()" id="build-route-btn" style="margin-top: 10px;">
                    –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç
                </button>
                <button class="btn btn-secondary" onclick="resetRoute()" style="margin-top: 10px; width: 100%;">
                    –°–±—Ä–æ—Å–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç
                </button>
            </div>

            <!-- –§–∏–ª—å—Ç—Ä—ã –ø–æ —Ç–∏–ø–∞–º —Ç–æ—á–µ–∫ Wi-Fi -->
            <div class="controls-section">
                <h3 style="font-size: 14px; margin-bottom: 10px;">–§–∏–ª—å—Ç—Ä—ã —Ç–æ—á–µ–∫ Wi-Fi</h3>
                <div class="filter-group">
                    <label style="display: flex; align-items: center; margin-bottom: 8px; cursor: pointer;">
                        <span class="legend-color" style="background: #51cf66; margin-right: 8px;"></span>
                        <input type="checkbox" id="filter-park" checked style="margin-right: 8px;" onchange="applyFilters()">
                        <span>–ü–∞—Ä–∫–∏</span>
                    </label>
                    <label style="display: flex; align-items: center; margin-bottom: 8px; cursor: pointer;">
                        <span class="legend-color" style="background: #ffd43b; margin-right: 8px;"></span>
                        <input type="checkbox" id="filter-library" checked style="margin-right: 8px;" onchange="applyFilters()">
                        <span>–ë–∏–±–ª–∏–æ—Ç–µ–∫–∏</span>
                    </label>
                    <label style="display: flex; align-items: center; margin-bottom: 8px; cursor: pointer;">
                        <span class="legend-color" style="background: #ff922b; margin-right: 8px;"></span>
                        <input type="checkbox" id="filter-cinema" checked style="margin-right: 8px;" onchange="applyFilters()">
                        <span>–ö–∏–Ω–æ—Ç–µ–∞—Ç—Ä—ã</span>
                    </label>
                    <label style="display: flex; align-items: center; margin-bottom: 8px; cursor: pointer;">
                        <span class="legend-color" style="background: #ae3ec9; margin-right: 8px;"></span>
                        <input type="checkbox" id="filter-cultural" checked style="margin-right: 8px;" onchange="applyFilters()">
                        <span>–ö—É–ª—å—Ç—É—Ä–Ω—ã–µ —Ü–µ–Ω—Ç—Ä—ã</span>
                    </label>
                    <label style="display: flex; align-items: center; margin-bottom: 8px; cursor: pointer;">
                        <span class="legend-color" style="background: #339af0; margin-right: 8px;"></span>
                        <input type="checkbox" id="filter-city" checked style="margin-right: 8px;" onchange="applyFilters()">
                        <span>–ì–æ—Ä–æ–¥—Å–∫–æ–π Wi-Fi</span>
                    </label>
                </div>
            </div>

            <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ—á–∫–∞—Ö -->
            <div id="points-info" class="points-info hidden">
                <h3>–í—ã–±—Ä–∞–Ω–Ω—ã–µ —Ç–æ—á–∫–∏</h3>
                <div class="point-item">
                    <strong>–¢–æ—á–∫–∞ A:</strong>
                    <span id="point-a-coords">–Ω–µ –≤—ã–±—Ä–∞–Ω–∞</span>
                </div>
                <div class="point-item">
                    <strong>–¢–æ—á–∫–∞ B:</strong>
                    <span id="point-b-coords">–Ω–µ –≤—ã–±—Ä–∞–Ω–∞</span>
                </div>
            </div>

            <!-- –°–æ–æ–±—â–µ–Ω–∏—è -->
            <div id="loading" class="loading hidden">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
            <div id="error" class="error hidden"></div>

            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –º–∞—Ä—à—Ä—É—Ç–∞ -->
            <div id="statistics" class="statistics hidden">
                <h3>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –º–∞—Ä—à—Ä—É—Ç–∞</h3>
                <div class="stat-item">
                    <strong>–û–±—â–∞—è –¥–ª–∏–Ω–∞:</strong> <span id="stat-distance">-</span>
                </div>
                <div class="stat-item">
                    <strong>–ü–æ–∫—Ä—ã—Ç–æ Wi-Fi:</strong> <span id="stat-coverage">-</span>
                </div>
                <div class="stat-item">
                    <strong>–¢–æ—á–µ–∫ Wi-Fi –Ω–∞ –º–∞—Ä—à—Ä—É—Ç–µ:</strong> <span id="stat-points">-</span>
                </div>
                <div id="wifi-points-list" class="wifi-points-list"></div>
            </div>
        </div>
    </div>

    <!-- –ö–∞—Ä—Ç–∞ -->
    <div class="map-container">
        <div id="map"></div>
    </div>

    <!-- –Ø–Ω–¥–µ–∫—Å –ö–∞—Ä—Ç—ã API -->
    <script src="https://api-maps.yandex.ru/2.1/?apikey=4133d44a-64c3-4a70-9a6f-d70999be5fb8&lang=ru_RU" type="text/javascript"></script>
    
    <script>
        console.log('üìÑ –°–∫—Ä–∏–ø—Ç –Ω–∞—á–∞–ª –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è...');
        
        const API_KEY = '4133d44a-64c3-4a70-9a6f-d70999be5fb8';
        const API_URL = 'http://localhost:3001/api';
        
        console.log('‚úÖ –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã');
        console.log('üîë API –∫–ª—é—á:', API_KEY ? '—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω' : '–ù–ï –£–°–¢–ê–ù–û–í–õ–ï–ù!');
        
        let map = null;
        let wifiPoints = [];
        let fromPoint = null;
        let toPoint = null;
        let routeObjects = [];
        let routeMarkers = [];
        let wifiMarkers = [];
        let pointMarkersCollection = null;
        let suggestControlA = null;
        let suggestControlB = null;
        let currentRouteData = null;
        let authToken = null; // JWT —Ç–æ–∫–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        let currentUser = null; // –¢–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

        // –¢–µ—Å—Ç –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        console.log('üöÄ –°–∫—Ä–∏–ø—Ç –∑–∞–≥—Ä—É–∂–µ–Ω!');
        console.log('üîë API –∫–ª—é—á:', API_KEY ? '—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω' : '–ù–ï –£–°–¢–ê–ù–û–í–õ–ï–ù!');
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Ä—Ç—ã
        ymaps.ready(function () {
            console.log('‚úÖ –Ø–Ω–¥–µ–∫—Å –ö–∞—Ä—Ç—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
            
            map = new ymaps.Map('map', {
                center: [55.7558, 37.6173],
                zoom: 12,
                controls: [] // –£–±–∏—Ä–∞–µ–º –≤—Å–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è, –≤–∫–ª—é—á–∞—è –ø–æ–∏—Å–∫
            });
            
            pointMarkersCollection = new ymaps.GeoObjectCollection();
            map.geoObjects.add(pointMarkersCollection);

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –Ω–∞ –∫–∞—Ä—Ç–µ
            map.events.add('click', function (e) {
                const coords = e.get('coords');
                
                if (!fromPoint) {
                    setPointA(coords);
                } else if (!toPoint) {
                    setPointB(coords);
                    // –ù–µ —Å—Ç—Ä–æ–∏–º –º–∞—Ä—à—Ä—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–º—ë—Ç –∫–Ω–æ–ø–∫—É
                } else {
                    resetRoute();
                    setPointA(coords);
                }
            });

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω
            checkAuth();
            
            loadWifiPoints();
        });
        
        // –§—É–Ω–∫—Ü–∏–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
        async function register() {
            const username = document.getElementById('register-username').value.trim();
            const email = document.getElementById('register-email').value.trim();
            const password = document.getElementById('register-password').value;
            
            if (!username || !email || !password) {
                showError('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                return;
            }
            
            showLoading('–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è...');
            hideError();
            
            try {
                const response = await fetch(`${API_URL}/auth/register`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ username, email, password })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    authToken = data.token;
                    currentUser = { id: data.userId, username: data.username };
                    localStorage.setItem('authToken', authToken);
                    localStorage.setItem('currentUser', JSON.stringify(currentUser));
                    
                    showUserInfo();
                    hideLoading();
                    showSuccess('–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞!');
                } else {
                    showError(data.message || '–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏');
                    hideLoading();
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:', error);
                showError('–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: ' + error.message);
                hideLoading();
            }
        }
        
        async function login() {
            const username = document.getElementById('login-username').value.trim();
            const password = document.getElementById('login-password').value;
            
            if (!username || !password) {
                showError('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                return;
            }
            
            showLoading('–í—Ö–æ–¥...');
            hideError();
            
            try {
                const response = await fetch(`${API_URL}/auth/login`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ username, password })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    authToken = data.token;
                    currentUser = { id: data.userId, username: data.username };
                    localStorage.setItem('authToken', authToken);
                    localStorage.setItem('currentUser', JSON.stringify(currentUser));
                    
                    showUserInfo();
                    hideLoading();
                    showSuccess('–í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ!');
                } else {
                    showError(data.message || '–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞');
                    hideLoading();
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞:', error);
                showError('–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞: ' + error.message);
                hideLoading();
            }
        }
        
        function logout() {
            authToken = null;
            currentUser = null;
            localStorage.removeItem('authToken');
            localStorage.removeItem('currentUser');
            
            showLoginForm();
        }
        
        function showLoginForm() {
            document.getElementById('login-form').style.display = 'block';
            document.getElementById('register-form').style.display = 'none';
            document.getElementById('user-info').style.display = 'none';
            document.getElementById('main-content').style.display = 'none';
        }
        
        function showRegisterForm() {
            document.getElementById('login-form').style.display = 'none';
            document.getElementById('register-form').style.display = 'block';
            document.getElementById('user-info').style.display = 'none';
            document.getElementById('main-content').style.display = 'none';
        }
        
        function showUserInfo() {
            document.getElementById('login-form').style.display = 'none';
            document.getElementById('register-form').style.display = 'none';
            document.getElementById('user-info').style.display = 'block';
            document.getElementById('main-content').style.display = 'block';
            
            if (currentUser) {
                document.getElementById('current-username').textContent = currentUser.username;
            }
        }
        
        async function checkAuth() {
            const savedToken = localStorage.getItem('authToken');
            const savedUser = localStorage.getItem('currentUser');
            
            if (savedToken && savedUser) {
                try {
                    const response = await fetch(`${API_URL}/auth/validate`, {
                        headers: {
                            'Authorization': `Bearer ${savedToken}`
                        }
                    });
                    
                    const data = await response.json();
                    
                    if (data.success) {
                        authToken = savedToken;
                        currentUser = JSON.parse(savedUser);
                        showUserInfo();
                    } else {
                        // –¢–æ–∫–µ–Ω –Ω–µ–≤–∞–ª–∏–¥–µ–Ω, –æ—á–∏—â–∞–µ–º
                        localStorage.removeItem('authToken');
                        localStorage.removeItem('currentUser');
                        showLoginForm();
                    }
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–æ–∫–µ–Ω–∞:', error);
                    showLoginForm();
                }
            } else {
                showLoginForm();
            }
        }
        
        function showSuccess(message) {
            const errorDiv = document.getElementById('error');
            errorDiv.textContent = message;
            errorDiv.style.color = '#28a745';
            errorDiv.style.background = '#d4edda';
            errorDiv.style.borderColor = '#c3e6cb';
            errorDiv.classList.remove('hidden');
            
            setTimeout(() => {
                errorDiv.classList.add('hidden');
            }, 3000);
        }

        // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–æ—á–∫—É A
        function setPointA(coords, address) {
            fromPoint = coords;
            addRouteMarker(coords, 'A', '#FF0000');
            updatePointInfo();
            map.setCenter(coords, 15);
        }

        // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–æ—á–∫—É B
        function setPointB(coords, address) {
            toPoint = coords;
            addRouteMarker(coords, 'B', '#FF69B4');
            updatePointInfo();
            // –ù–µ —Å—Ç—Ä–æ–∏–º –º–∞—Ä—à—Ä—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–º—ë—Ç –∫–Ω–æ–ø–∫—É
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ—á–µ–∫ Wi-Fi
        async function loadWifiPoints() {
            showLoading('–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ—á–µ–∫ Wi-Fi...');
            hideError();

            try {
                const response = await fetch(`${API_URL}/wifi-points`);
                const data = await response.json();

                if (data.success && data.data) {
                    wifiPoints = data.data;
                    visualizeWifiPoints(wifiPoints);
                    hideLoading();
                    console.log(`‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${wifiPoints.length} —Ç–æ—á–µ–∫ Wi-Fi`);
                } else {
                    throw new Error('–ù–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ—á–µ–∫:', error);
                showError('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ç–æ—á–∫–∏ Wi-Fi. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ backend –∑–∞–ø—É—â–µ–Ω –Ω–∞ http://localhost:3001');
                hideLoading();
            }
        }

        let isFirstLoad = true;

        // –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ —Ç–∏–ø–∞–º —Ç–æ—á–µ–∫ Wi-Fi
        function applyFilters() {
            if (wifiPoints.length === 0) return;
            
            const filters = {
                park: document.getElementById('filter-park').checked,
                library: document.getElementById('filter-library').checked,
                cinema: document.getElementById('filter-cinema').checked,
                cultural_center: document.getElementById('filter-cultural').checked,
                city_wifi: document.getElementById('filter-city').checked
            };
            
            // –§–∏–ª—å—Ç—Ä—É–µ–º —Ç–æ—á–∫–∏ –ø–æ –≤—ã–±—Ä–∞–Ω–Ω—ã–º —Ç–∏–ø–∞–º
            const filteredPoints = wifiPoints.filter(point => {
                return filters[point.type] !== false;
            });
            
            console.log(`–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è: –ø–æ–∫–∞–∑–∞–Ω–æ ${filteredPoints.length} –∏–∑ ${wifiPoints.length} —Ç–æ—á–µ–∫`);
            visualizeWifiPoints(filteredPoints);
        }

        function visualizeWifiPoints(points) {
            if (!map) return;

            wifiMarkers.forEach(marker => {
                map.geoObjects.remove(marker);
            });
            wifiMarkers = [];

            points.forEach(point => {
                const marker = new ymaps.Placemark(
                    [point.lat, point.lng],
                    {
                        balloonContent: `
                            <strong>${point.name}</strong><br/>
                            –¢–∏–ø: ${getTypeName(point.type)}<br/>
                            –ê–¥—Ä–µ—Å: ${point.address || '–ù–µ —É–∫–∞–∑–∞–Ω'}
                        `,
                        iconCaption: point.name
                    },
                    {
                        preset: getIconPreset(point.type),
                        iconColor: getIconColor(point.type)
                    }
                );

                map.geoObjects.add(marker);
                wifiMarkers.push(marker);
            });

            if (isFirstLoad && points.length > 0) {
                isFirstLoad = false;
                const bounds = map.geoObjects.getBounds();
                if (bounds) {
                    map.setBounds(bounds, { duration: 500, checkZoomRange: true });
                }
            }
        }
        
        // –ü–æ–ª—É—á–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–∏–ø–∞ –Ω–∞ —Ä—É—Å—Å–∫–æ–º
        function getTypeName(type) {
            const names = {
                park: '–ü–∞—Ä–∫',
                library: '–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞',
                cinema: '–ö–∏–Ω–æ—Ç–µ–∞—Ç—Ä',
                cultural_center: '–ö—É–ª—å—Ç—É—Ä–Ω—ã–π —Ü–µ–Ω—Ç—Ä',
                city_wifi: '–ì–æ—Ä–æ–¥—Å–∫–æ–π Wi-Fi'
            };
            return names[type] || type;
        }

        function getIconPreset(type) {
            const presets = {
                library: 'islands#blueLibraryIcon',
                cinema: 'islands#redCinemaIcon',
                park: 'islands#greenParkIcon',
                cultural_center: 'islands#orangeCultureIcon',
                city_wifi: 'islands#blueDotIcon'
            };
            return presets[type] || 'islands#blueDotIcon';
        }

        function getIconColor(type) {
            const colors = {
                library: '#ffd43b', // –ñ—ë–ª—Ç—ã–π –¥–ª—è –±–∏–±–ª–∏–æ—Ç–µ–∫
                cinema: '#ff922b', // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –∫–∏–Ω–æ—Ç–µ–∞—Ç—Ä–æ–≤
                park: '#51cf66', // –ó–µ–ª—ë–Ω—ã–π –¥–ª—è –ø–∞—Ä–∫–æ–≤
                cultural_center: '#ae3ec9', // –§–∏–æ–ª–µ—Ç–æ–≤—ã–π –¥–ª—è –∫—É–ª—å—Ç—É—Ä–Ω—ã—Ö —Ü–µ–Ω—Ç—Ä–æ–≤
                city_wifi: '#339af0' // –°–∏–Ω–∏–π –¥–ª—è –≥–æ—Ä–æ–¥—Å–∫–æ–≥–æ Wi-Fi
            };
            return colors[type] || '#339af0';
        }

        function addRouteMarker(coords, label, color) {
            if (!map || !pointMarkersCollection) return;

            // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–π –º–∞—Ä–∫–µ—Ä, –µ—Å–ª–∏ –æ–Ω —É–∂–µ –µ—Å—Ç—å
            const existingMarker = routeMarkers.find(m => {
                const markerLabel = m.properties.get('label');
                return markerLabel === label;
            });
            if (existingMarker) {
                pointMarkersCollection.remove(existingMarker);
                const index = routeMarkers.indexOf(existingMarker);
                if (index > -1) {
                    routeMarkers.splice(index, 1);
                }
            }

            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ü–≤–µ—Ç–∞: –∫—Ä–∞—Å–Ω–æ–µ —Å –±–µ–ª—ã–º –¥–ª—è A, —á–µ—Ä–Ω–æ–µ —Å –±–µ–ª—ã–º –¥–ª—è B
            const outerColor = label === 'A' ? '#FF0000' : '#000000';
            const innerColor = '#FFFFFF';
            
            // –°–æ–∑–¥–∞—ë–º –º–∞—Ä–∫–µ—Ä —Å —Ü–≤–µ—Ç–Ω–æ–π –æ–±–≤–æ–¥–∫–æ–π –∏ –±–µ–ª–æ–π –∑–∞–ª–∏–≤–∫–æ–π
            const marker = new ymaps.Placemark(
                coords,
                { 
                    balloonContent: `–¢–æ—á–∫–∞ ${label}`,
                    label: label
                },
                {
                    iconLayout: 'default#imageWithContent',
                    iconImageHref: 'data:image/svg+xml;base64,' + btoa(
                        '<svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30">' +
                        '<circle cx="15" cy="15" r="14" fill="' + outerColor + '" stroke="' + outerColor + '" stroke-width="2"/>' +
                        '<circle cx="15" cy="15" r="10" fill="' + innerColor + '"/>' +
                        '</svg>'
                    ),
                    iconImageSize: [30, 30],
                    iconImageOffset: [-15, -15]
                }
            );

            pointMarkersCollection.add(marker);
            routeMarkers.push(marker);
        }

        function updatePointInfo() {
            const infoDiv = document.getElementById('points-info');
            const pointA = document.getElementById('point-a-coords');
            const pointB = document.getElementById('point-b-coords');

            if (fromPoint || toPoint) {
                infoDiv.classList.remove('hidden');
                pointA.textContent = fromPoint ? `${fromPoint[0].toFixed(6)}, ${fromPoint[1].toFixed(6)}` : '–Ω–µ –≤—ã–±—Ä–∞–Ω–∞';
                pointB.textContent = toPoint ? `${toPoint[0].toFixed(6)}, ${toPoint[1].toFixed(6)}` : '–Ω–µ –≤—ã–±—Ä–∞–Ω–∞';
            } else {
                infoDiv.classList.add('hidden');
            }
        }

        async function buildRoute() {
            if (!fromPoint || !toPoint) {
                showError('–í—ã–±–µ—Ä–∏—Ç–µ –æ–±–µ —Ç–æ—á–∫–∏ (A –∏ B) –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –º–∞—Ä—à—Ä—É—Ç–∞');
                return;
            }

            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–Ω–æ–ø–∫–∏
            const buildBtn = document.getElementById('build-route-btn');
            buildBtn.disabled = true;
            buildBtn.textContent = '–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–∞...';

            showLoading('–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–∞...');
            hideError();
            hideStatistics();

            // –ü–æ–ª—É—á–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ç–∏–ø –º–∞—Ä—à—Ä—É—Ç–∞
            const routeTypeInput = document.querySelector('input[name="route-type"]:checked');
            const routeType = routeTypeInput ? routeTypeInput.value : 'max_coverage';
            
            console.log('–¢–∏–ø –º–∞—Ä—à—Ä—É—Ç–∞:', routeType);

            try {
                const url = `${API_URL}/route?from_lat=${fromPoint[0]}&from_lng=${fromPoint[1]}&to_lat=${toPoint[0]}&to_lng=${toPoint[1]}&route_type=${routeType}`;
                console.log('–ó–∞–ø—Ä–æ—Å –º–∞—Ä—à—Ä—É—Ç–∞:', url);
                const response = await fetch(url);
                const data = await response.json();

                if (data.success) {
                    currentRouteData = data;
                    console.log('–î–∞–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç–∞:', data);
                    console.log('–ó–æ–Ω—ã –ø–æ–∫—Ä—ã—Ç–∏—è:', data.coverageZones || data.coverage_zones);
                    visualizeRoute(data);
                    showStatistics(data.statistics, data.coverageZones || data.coverage_zones);
                    hideLoading();
                } else {
                    throw new Error(data.message || '–û—à–∏–±–∫–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –º–∞—Ä—à—Ä—É—Ç–∞');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –º–∞—Ä—à—Ä—É—Ç–∞:', error);
                showError('–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç: ' + error.message);
                hideLoading();
            } finally {
                // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–Ω–æ–ø–∫—É
                const buildBtn = document.getElementById('build-route-btn');
                buildBtn.disabled = false;
                buildBtn.textContent = '–ü–æ—Å—Ç—Ä–æ–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç';
            }
        }

        function visualizeRoute(routeData) {
            if (!map) return;

            routeObjects.forEach(obj => {
                map.geoObjects.remove(obj);
            });
            routeObjects = [];

            const zones = routeData.coverageZones || routeData.coverage_zones;
            if (zones) {
                zones.forEach(zone => {
                    const lat = zone.lat || (zone.center && zone.center.lat);
                    const lng = zone.lng || (zone.center && zone.center.lng);
                    const radius = zone.radius || 50;
                    
                    if (lat && lng) {
                        const circle = new ymaps.Circle(
                            [[lat, lng], radius],
                            {},
                            {
                                fillColor: '#0088FF',
                                fillOpacity: 0.2,
                                strokeColor: '#0088FF',
                                strokeWidth: 2
                            }
                        );
                        map.geoObjects.add(circle);
                        routeObjects.push(circle);
                    }
                });
            }

            if (routeData.route) {
                const routeCoordinates = routeData.route.map(coord => {
                    if (Array.isArray(coord)) {
                        return coord;
                    } else if (coord.lat && coord.lng) {
                        return [coord.lat, coord.lng];
                    } else {
                        return [coord[0], coord[1]];
                    }
                });

                const polyline = new ymaps.Polyline(
                    routeCoordinates,
                    {},
                    {
                        strokeColor: '#FF0000',
                        strokeWidth: 4,
                        strokeOpacity: 0.7
                    }
                );
                map.geoObjects.add(polyline);
                routeObjects.push(polyline);

                try {
                    const bounds = map.geoObjects.getBounds();
                    if (bounds) {
                        const currentBounds = map.getBounds();
                        const needsZoom = !currentBounds || 
                                        !currentBounds.contains(bounds[0]) || 
                                        !currentBounds.contains(bounds[1]);
                        
                        if (needsZoom) {
                            map.setBounds(bounds, {
                                duration: 800,
                                checkZoomRange: true,
                                zoomMargin: 50
                            });
                        }
                    }
                } catch (e) {
                    console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≥—Ä–∞–Ω–∏—Ü—ã –∫–∞—Ä—Ç—ã:', e);
                }
            }
        }

        function showStatistics(stats, coverageZones) {
            if (!stats) return;

            const statsDiv = document.getElementById('statistics');
            const statDistance = document.getElementById('stat-distance');
            const statCoverage = document.getElementById('stat-coverage');
            const statPoints = document.getElementById('stat-points');
            const wifiPointsList = document.getElementById('wifi-points-list');

            statsDiv.classList.remove('hidden');
            
            const totalDistance = stats.totalDistanceMeters || stats.total_distance_meters || 0;
            const coverage = stats.coveragePercentage || stats.coverage_percentage || 0;
            const wifiPointsCount = stats.wifiPointsAlongRoute || stats.wifi_points_along_route || 0;
            
            statDistance.textContent = `${totalDistance} –º`;
            statCoverage.textContent = `${coverage.toFixed(1)}%`;
            statPoints.textContent = wifiPointsCount;

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–ø–∏—Å–æ–∫ —Ç–æ—á–µ–∫ Wi-Fi
            wifiPointsList.innerHTML = '';
            if (coverageZones && coverageZones.length > 0) {
                console.log('–ó–æ–Ω—ã –ø–æ–∫—Ä—ã—Ç–∏—è (–ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ):', JSON.stringify(coverageZones, null, 2));
                
                coverageZones.forEach((zone, index) => {
                    console.log(`–ó–æ–Ω–∞ ${index}:`, zone);
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –¥–∞–Ω–Ω—ã—Ö (camelCase –∏ snake_case)
                    let name = zone.name || zone.Name || zone.wifiPointName || null;
                    let address = zone.address || zone.Address || zone.wifiPointAddress || null;
                    const type = zone.type || zone.Type || 'unknown';
                    
                    // –ï—Å–ª–∏ name –∏–ª–∏ address –Ω–µ –Ω–∞–π–¥–µ–Ω—ã, –ø—ã—Ç–∞–µ–º—Å—è –Ω–∞–π—Ç–∏ —Ç–æ—á–∫—É Wi-Fi –ø–æ ID
                    if (!name || !address) {
                        const wifiPointId = zone.wifiPointId || zone.wifi_point_id || zone.id;
                        if (wifiPointId && wifiPoints.length > 0) {
                            const wifiPoint = wifiPoints.find(p => p.id === wifiPointId);
                            if (wifiPoint) {
                                name = name || wifiPoint.name || '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
                                address = address || wifiPoint.address || '–ê–¥—Ä–µ—Å –Ω–µ —É–∫–∞–∑–∞–Ω';
                                console.log(`–ù–∞–π–¥–µ–Ω–∞ —Ç–æ—á–∫–∞ Wi-Fi –ø–æ ID ${wifiPointId}:`, wifiPoint);
                            }
                        }
                    }
                    
                    // –ï—Å–ª–∏ –≤—Å—ë –µ—â—ë –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
                    name = name || '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
                    address = address || '–ê–¥—Ä–µ—Å –Ω–µ —É–∫–∞–∑–∞–Ω';
                    
                    console.log(`–û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ç–æ—á–∫—É ${index}:`, { name, address, type });
                    
                    const item = document.createElement('div');
                    item.className = 'wifi-point-item';
                    item.innerHTML = `
                        <strong>${name}</strong>
                        <div class="address">${address}</div>
                    `;
                    wifiPointsList.appendChild(item);
                });
            } else {
                console.log('–ó–æ–Ω—ã –ø–æ–∫—Ä—ã—Ç–∏—è –ø—É—Å—Ç—ã –∏–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã');
                wifiPointsList.innerHTML = '<div style="padding: 10px; color: #666; font-size: 12px;">–¢–æ—á–∫–∏ Wi-Fi –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';
            }
        }

        function resetRoute() {
            fromPoint = null;
            toPoint = null;
            currentRouteData = null;

            if (pointMarkersCollection) {
                pointMarkersCollection.removeAll();
            }
            routeMarkers = [];

            routeObjects.forEach(obj => {
                map.geoObjects.remove(obj);
            });
            routeObjects = [];

            updatePointInfo();
            hideStatistics();
            hideError();

            // –ù–ï –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Ç–æ—á–∫–∏ Wi-Fi - –æ–Ω–∏ –æ—Å—Ç–∞—é—Ç—Å—è –Ω–∞ –∫–∞—Ä—Ç–µ
            // –≠—Ç–æ —ç–∫–æ–Ω–æ–º–∏—Ç –≤—Ä–µ–º—è –∏ –Ω–µ –º–µ—à–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
        }

        function showLoading(message) {
            const loadingDiv = document.getElementById('loading');
            loadingDiv.textContent = message || '–ó–∞–≥—Ä—É–∑–∫–∞...';
            loadingDiv.classList.remove('hidden');
        }

        function hideLoading() {
            document.getElementById('loading').classList.add('hidden');
        }

        function showError(message) {
            const errorDiv = document.getElementById('error');
            errorDiv.textContent = message;
            errorDiv.classList.remove('hidden');
        }

        function hideError() {
            document.getElementById('error').classList.add('hidden');
        }

        function hideStatistics() {
            document.getElementById('statistics').classList.add('hidden');
        }
    </script>
</body>
</html>
